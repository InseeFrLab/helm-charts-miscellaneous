{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "properties": {
        "lomas-server": {
            "type": "object",
            "properties": {
                "fullnameOverride": {
                    "type": "string",
                    "x-onyxia": {
                        "hidden": false,
                        "overwriteDefaultWith":"{{project.id}}-{{k8s.randomSubdomain}}-lomas"
                    }
                },
                "nameOverride": {
                    "type": "string",
                    "default": "",
                    "abc": false
                },
                "dashboard": {
                    "title": "Dashboard Configuration",
                    "type": "object",
                    "properties": {
                        "affinity": {
                            "type": "object",
                            "default": {},
                            "abc": false
                        },
                        "create": {
                            "type": "boolean",
                            "default": true,
                            "abc": false
                        },
                        "image": {
                            "description": "Docker Image",
                            "type": "object",
                            "properties": {
                                "pullPolicy": {
                                    "type": "string",
                                    "description": "option when pulling the docker image",
                                    "default": "Always",
                                    "enum": [
                                        "IfNotPresent",
                                        "Always",
                                        "Never"
                                    ]
                                },
                                "repository": {
                                    "type": "string",
                                    "default": "dsccadminch/lomas_admin_dashboard",
                                    "enum": [
                                        "dsccadminch/lomas_admin_dashboard"
                                    ]
                                },
                                "tag": {
                                    "type": "string",
                                    "default": "0.4.0",
                                    "enum": [
                                        "latest",
                                        "0.3.1",
                                        "0.3.5",
                                        "0.4.0"
                                    ]
                                }
                            }
                        },
                        "imagePullSecrets": {
                            "type": "array",
                            "default": [],
                            "abc": false
                        },
                        "ingress": {
                            "type": "object",
                            "properties": {
                                "annotations": {
                                    "type": "object",
                                    "abc": false,
                                    "properties": {
                                        "nginx.ingress.kubernetes.io/proxy-read-timeout": {
                                            "type": "string",
                                            "default": "3600"
                                        }
                                    }
                                },
                                "className": {
                                    "type": "string",
                                    "default": "nginx",
                                    "abc": false
                                },
                                "enabled": {
                                    "type": "boolean",
                                    "default": true,
                                    "abc": false
                                },
                                "hostname": {
                                    "type": "string",
                                    "title":"Hostname",
                                    "x-onyxia": {
                                        "hidden": false,
                                        "overwriteDefaultWith": "{{project.id}}-{{k8s.randomSubdomain}}-lomas-admin-dashboard-{{k8s.domain}}"
                                    }
                                }
                            }
                        },
                        "podAnnotations": {
                            "type": "object",
                            "default": {},
                            "abc": false
                        },
                        "podSecurityContext": {
                            "type": "object",
                            "default": {},
                            "abc": false
                        },
                        "replicaCount": {
                            "type": "integer",
                            "default": 1,
                            "abc": false
                        },
                        "resources": {
                            "type": "object",
                            "description": "Your service will have at least the requested resources and never more than its limits. No limit for a resource and you can consume everything left on the host machine.",
                            "properties": {
                                "requests": {
                                    "description": "Guaranteed resources",
                                    "type": "object",
                                    "properties": {
                                        "cpu": {
                                            "description": "The amount of cpu guaranteed",
                                            "title": "CPU",
                                            "type": "string",
                                            "default": "100m",
                                            "render": "slider",
                                            "sliderMin": 50,
                                            "sliderMax": 40000,
                                            "sliderStep": 50,
                                            "sliderUnit": "m",
                                            "sliderExtremity": "down",
                                            "sliderExtremitySemantic": "guaranteed",
                                            "sliderRangeId": "cpu"
                                        },
                                        "memory": {
                                            "description": "The amount of memory guaranteed",
                                            "title": "memory",
                                            "type": "string",
                                            "default": "2Gi",
                                            "render": "slider",
                                            "sliderMin": 1,
                                            "sliderMax": 200,
                                            "sliderStep": 1,
                                            "sliderUnit": "Gi",
                                            "sliderExtremity": "down",
                                            "sliderExtremitySemantic": "guaranteed",
                                            "sliderRangeId": "memory"
                                        }
                                    }
                                },
                                "limits": {
                                    "description": "max resources",
                                    "type": "object",
                                    "properties": {
                                        "cpu": {
                                            "description": "The maximum amount of cpu",
                                            "title": "CPU",
                                            "type": "string",
                                            "default": "30000m",
                                            "render": "slider",
                                            "sliderMin": 50,
                                            "sliderMax": 40000,
                                            "sliderStep": 50,
                                            "sliderUnit": "m",
                                            "sliderExtremity": "up",
                                            "sliderExtremitySemantic": "Maximum",
                                            "sliderRangeId": "cpu",
                                            "x-onyxia": {
                                                "overwriteDefaultWith": "region.resources.cpuLimit",
                                                "useRegionSliderConfig": "cpu"
                                            }
                                        },
                                        "memory": {
                                            "description": "The maximum amount of memory",
                                            "title": "Memory",
                                            "type": "string",
                                            "default": "50Gi",
                                            "render": "slider",
                                            "sliderMin": 1,
                                            "sliderMax": 200,
                                            "sliderStep": 1,
                                            "sliderUnit": "Gi",
                                            "sliderExtremity": "up",
                                            "sliderExtremitySemantic": "Maximum",
                                            "sliderRangeId": "memory",
                                            "x-onyxia": {
                                                "overwriteDefaultWith": "region.resources.memoryLimit",
                                                "useRegionSliderConfig": "memory"
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "securityContext": {
                            "type": "object",
                            "default": {},
                            "abc": false
                        },
                        "serverConfig": {
                            "type": "object",
                            "properties": {
                                "address": {
                                    "type": "string",
                                    "default": "0.0.0.0",
                                    "abc": false
                                },
                                "port": {
                                    "type": "string",
                                    "default": "8501",
                                    "abc": false
                                }
                            }
                        },
                        "service": {
                            "description": "Service specific configuration",
                            "type": "object",
                            "properties": {
                                "port": {
                                    "description": "Port of the service",
                                    "type": "integer",
                                    "default": 80
                                },
                                "type": {
                                    "description": "type of the service",
                                    "type": "string",
                                    "default": "ClusterIP",
                                    "abc": false
                                }
                            }
                        },
                        "tolerations": {
                            "type": "array",
                            "description": "Array of tolerations",
                            "default": [],
                            "x-onyxia": {
                                "hidden": false,
                                "overwriteDefaultWith": "region.tolerations"
                            }
                        },
                        "nodeSelector": {
                            "type": "object",
                            "description": "NodeSelector",
                            "default": {},
                            "x-onyxia": {
                                "hidden": false,
                                "overwriteDefaultWith": "region.nodeSelector"
                            }
                        },
                        "serviceAccount": {
                            "type": "object",
                            "abc": false,
                            "properties": {
                                "annotations": {
                                    "type": "object"
                                },
                                "create": {
                                    "type": "boolean",
                                    "default": false
                                },
                                "name": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "mongodb": {
                    "type": "object",
                    "properties": {
                        "max_pool_size": {
                            "description": "Total number of open connections (active + idle) allowed in the pool.",
                            "type": "integer",
                            "default": 100
                        },
                        "min_pool_size": {
                            "description": "Minimum number of idle connections that will be maintained, even when the application is idle or under low load.",
                            "type": "integer",
                            "default": 2
                        },
                        "max_connecting": {
                            "description": "Controls the number of simultaneous new connection attempts being made.",
                            "type": "integer",
                            "default": 2
                        },
                        "architecture": {
                            "type": "string",
                            "default": "standalone",
                            "abc": false
                        },
                        "auth": {
                            "type": "object",
                            "description": "Authentification configuration",
                            "properties": {
                                "enabled": {
                                    "type": "boolean",
                                    "description": "add mongodb to server",
                                    "default": true
                                },
                                "rootUser": {
                                    "type": "string",
                                    "description": "root name",
                                    "default": "root"
                                },
                                "rootPassword": {
                                    "type": "string",
                                    "description": "root password",
                                    "default": "changeme",
                                    "x-onyxia": {
                                        "overwriteDefaultWith": "{{project.password}}"
                                    }
                                },
                                "databases": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    },
                                    "description": "default databases",
                                    "default": ["defaultdb"]
                                },
                                "usernames": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    },
                                    "description": "default usernames",
                                    "default": ["user"]
                                },
                                "passwords": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    },
                                    "description": "default passwords",
                                    "default": ["change_me"],
                                    "x-onyxia": {
                                        "overwriteDefaultWith": ["{{project.password}}"]
                                    }
                                }
                            }
                        },
                        "discoverable": {
                            "type": "object",
                            "abc": false,
                            "properties": {
                                "allow": {
                                    "type": "boolean",
                                    "default": true
                                }
                            }
                        },
                        "fullnameOverride": {
                            "type": "string",
                            "x-onyxia": {
                                "hidden": false,
                                "overwriteDefaultWith":"{{project.id}}-{{k8s.randomSubdomain}}-lomas-mongodb"
                            }
                        },
                        "image": {
                            "type": "object",
                            "description": "image specific configuration",
                            "properties": {
                                "tag": {
                                    "type": "string",
                                    "description": "mongodb version",
                                    "default": "6.0.9-debian-11-r5"
                                }
                            }
                        },
                        "persistence": {
                            "type": "object",
                            "description": "configuration for persistence",
                            "properties": {
                                "resourcePolicy": {
                                    "description": "Set this to 'keep' to disable data pvc deletion when uninstalling the chart. Subsequent installs will use the same pvc, restoring the state of the server. Note: if the runtime_args.settings.develop_mode is set to True, the server state will be reset (default datasets and budgets).",
                                    "enum": [
                                        "",
                                        "keep"
                                    ],
                                    "type": "string",
                                    "default": ""
                                }
                            },
                            "enabled": {
                                "type": "boolean",
                                "description": "Create a persistent volume",
                                "default": true
                            },
                            "size": {
                                "type": "string",
                                "title": "Persistent volume size",
                                "description": "Size of the persistent volume",
                                "default": "10Gi",
                                "render": "slider",
                                "sliderMin": 1,
                                "sliderMax": 100,
                                "sliderStep": 1,
                                "sliderUnit": "Gi",
                                "abc": {
                                    "value": false,
                                    "path": "mongodb/persistence/enabled"
                                }
                            }
                        },
                        "replicaCount": {
                            "type": "integer",
                            "default": 1,
                            "abc": false
                        },
                        "resources": {
                            "type": "object",
                            "default": {},
                            "abc": false
                        },
                        "security": {
                            "description": "security specific configuration",
                            "type": "object",
                            "properties": {
                                "networkPolicy": {
                                    "type": "object",
                                    "description": "Define access policy to the service",
                                    "properties": {
                                        "enabled": {
                                            "type": "boolean",
                                            "title": "Enable network policy",
                                            "description": "Only pod from the same namespace will be allowed",
                                            "default": true,
                                            "x-onyxia": {
                                                "overwriteDefaultWith": "region.defaultNetworkPolicy"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "server": {
                    "title": "Server Configuration",
                    "type": "object",
                    "properties": {
                        "affinity": {
                            "type": "object",
                            "default": {},
                            "abc": false
                        },
                        "image": {
                            "description": "Docker Image",
                            "type": "object",
                            "properties": {
                                "pullPolicy": {
                                    "type": "string",
                                    "description": "option when pulling the docker image",
                                    "default": "Always",
                                    "enum": [
                                        "IfNotPresent",
                                        "Always",
                                        "Never"
                                    ]
                                },
                                "repository": {
                                    "type": "string",
                                    "default": "dsccadminch/lomas_server",
                                    "enum": [
                                        "dsccadminch/lomas_server"
                                    ]
                                },
                                "tag": {
                                    "type": "string",
                                    "default": "0.4.0",
                                    "enum": [
                                        "latest",
                                        "0.3.1",
                                        "0.3.5",
                                        "0.4.0"
                                    ]
                                }
                            }
                        },
                        "imagePullSecrets": {
                            "type": "array",
                            "default": [],
                            "abc": false
                        },
                        "ingress": {
                            "type": "object",
                            "properties": {
                                "annotations": {
                                    "type": "object",
                                    "abc": false,
                                    "properties": {
                                        "nginx.ingress.kubernetes.io/proxy-read-timeout": {
                                            "type": "string",
                                            "default": "3600"
                                        }
                                    }
                                },
                                "className": {
                                    "type": "string",
                                    "default": "nginx",
                                    "abc": false
                                },
                                "enabled": {
                                    "type": "boolean",
                                    "default": true,
                                    "abc": false
                                },
                                "hostname": {
                                    "type": "string",
                                    "title":"Hostname",
                                    "x-onyxia": {
                                        "hidden": false,
                                        "overwriteDefaultWith": "{{project.id}}-{{k8s.randomSubdomain}}-lomas-server-{{k8s.domain}}"
                                    }
                                }
                            }
                        },
                        "podAnnotations": {
                            "type": "object",
                            "default": {},
                            "abc": false
                        },
                        "podSecurityContext": {
                            "type": "object",
                            "default": {},
                            "abc": false
                        },
                        "replicaCount": {
                            "type": "integer",
                            "default": 1,
                            "abc": false
                        },
                        "resources": {
                            "description": "Your service will have at least the requested resources and never more than its limits. No limit for a resource and you can consume everything left on the host machine.",
                            "type": "object",
                            "properties": {
                                "requests": {
                                    "description": "Guaranteed resources",
                                    "type": "object",
                                    "properties": {
                                        "cpu": {
                                            "description": "The amount of cpu guaranteed",
                                            "title": "CPU",
                                            "type": "string",
                                            "default": "100m",
                                            "render": "slider",
                                            "sliderMin": 50,
                                            "sliderMax": 40000,
                                            "sliderStep": 50,
                                            "sliderUnit": "m",
                                            "sliderExtremity": "down",
                                            "sliderExtremitySemantic": "guaranteed",
                                            "sliderRangeId": "cpu"
                                        },
                                        "memory": {
                                            "description": "The amount of memory guaranteed",
                                            "title": "memory",
                                            "type": "string",
                                            "default": "2Gi",
                                            "render": "slider",
                                            "sliderMin": 1,
                                            "sliderMax": 200,
                                            "sliderStep": 1,
                                            "sliderUnit": "Gi",
                                            "sliderExtremity": "down",
                                            "sliderExtremitySemantic": "guaranteed",
                                            "sliderRangeId": "memory"
                                        }
                                    }
                                },
                                "limits": {
                                    "description": "max resources",
                                    "type": "object",
                                    "properties": {
                                        "cpu": {
                                            "description": "The maximum amount of cpu",
                                            "title": "CPU",
                                            "type": "string",
                                            "default": "30000m",
                                            "render": "slider",
                                            "sliderMin": 50,
                                            "sliderMax": 40000,
                                            "sliderStep": 50,
                                            "sliderUnit": "m",
                                            "sliderExtremity": "up",
                                            "sliderExtremitySemantic": "Maximum",
                                            "sliderRangeId": "cpu",
                                            "x-onyxia": {
                                                "overwriteDefaultWith": "region.resources.cpuLimit",
                                                "useRegionSliderConfig": "cpu"
                                            }
                                        },
                                        "memory": {
                                            "description": "The maximum amount of memory",
                                            "title": "Memory",
                                            "type": "string",
                                            "default": "50Gi",
                                            "render": "slider",
                                            "sliderMin": 1,
                                            "sliderMax": 200,
                                            "sliderStep": 1,
                                            "sliderUnit": "Gi",
                                            "sliderExtremity": "up",
                                            "sliderExtremitySemantic": "Maximum",
                                            "sliderRangeId": "memory",
                                            "x-onyxia": {
                                                "overwriteDefaultWith": "region.resources.memoryLimit",
                                                "useRegionSliderConfig": "memory"
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "runtime_args": {
                            "type": "object",
                            "properties": {
                                "settings": {
                                    "type": "object",
                                    "properties": {
                                        "develop_mode": {
                                            "description": "When True, service database is reset to default user and dataset collections.",
                                            "type": "boolean",
                                            "default": true
                                        },
                                        "submit_limit": {
                                            "description": "Currently unused, maximum query rate",
                                            "type": "integer",
                                            "default": 300,
                                            "abc": false
                                        },
                                        "server": {
                                            "type": "object",
                                            "description": "server configuration",
                                            "properties": {
                                                "time_attack": {
                                                    "type": "object",
                                                    "description": "methods to avoid time side channel attack",
                                                    "properties": {
                                                        "magnitude": {
                                                            "type": "integer",
                                                            "description": "Noise magnitude",
                                                            "default": 1
                                                        },
                                                        "method": {
                                                            "enum": [
                                                                "jitter",
                                                                "stall"
                                                            ],
                                                            "type": "string",
                                                            "description": "method for noise addition",
                                                            "default": "jitter"
                                                        }
                                                    }
                                                },
                                                "host_ip": {
                                                    "type": "string",
                                                    "description": "ip host of server",
                                                    "default": "0.0.0.0"
                                                },
                                                "host_port": {
                                                    "type": "string",
                                                    "description": "port of server",
                                                    "default": "80"
                                                },
                                                "log_level": {
                                                    "enum": [
                                                        "notset",
                                                        "debug",
                                                        "info",
                                                        "warning",
                                                        "error",
                                                        "critical"
                                                    ],
                                                    "type": "string",
                                                    "description": "level of verbosity",
                                                    "default": "info"
                                                },
                                                "reload": {
                                                    "type": "boolean",
                                                    "description": "automatic reload of server",
                                                    "default": false
                                                },
                                                "workers": {
                                                    "type": "integer",
                                                    "description": "number of workers",
                                                    "default": 1,
                                                    "abc": false
                                                }
                                            }
                                        },
                                        "dp_libraries": {
                                            "description": "Settings for DP libraries",
                                            "type": "object",
                                            "properties": {
                                                "opendp": {
                                                    "description": "Settings for opendp library",
                                                    "type": "object",
                                                    "properties": {
                                                        "contrib": {
                                                            "description": "Enable contrib feature",
                                                            "type": "boolean",
                                                            "default": true
                                                        },
                                                        "floating_point": {
                                                            "description": "Enable floating-point feature",
                                                            "type": "boolean",
                                                            "default": true
                                                        },
                                                        "honest_but_curious": {
                                                            "description": "Enable honest-but-curious feature",
                                                            "type": "boolean",
                                                            "default": true
                                                        }
                                                    }
                                                }
                                            }
                                        },
                                        "private_db_credentials": {
                                            "description": "List of credentials to access private dataset",
                                            "type": "array",
                                            "default": [],
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "db_type": {
                                                        "type": "string",
                                                        "description": "Type of the private database",
                                                        "enum": ["S3_DB"]
                                                    },
                                                    "access_key_id": {
                                                        "type": "string",
                                                        "description": "Access key ID for the private database"
                                                    },
                                                    "secret_access_key": {
                                                        "type": "string",
                                                        "description": "Secret access key for the private database"
                                                    },
                                                    "credentials_name": {
                                                        "type": "string",
                                                        "description": "Unique name for the database credentials"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "securityContext": {
                            "type": "object",
                            "default": {},
                            "abc": false
                        },
                        "service": {
                            "description": "Service specific configuration",
                            "type": "object",
                            "properties": {
                                "port": {
                                    "description": "Port of the service",
                                    "type": "integer",
                                    "default": 80
                                },
                                "type": {
                                    "description": "type of the service",
                                    "type": "string",
                                    "default": "ClusterIP",
                                    "abc": false
                                }
                            }
                        },
                        "tolerations": {
                            "type": "array",
                            "description": "Array of tolerations",
                            "default": [],
                            "x-onyxia": {
                                "hidden": false,
                                "overwriteDefaultWith": "region.tolerations"
                            }
                        },
                        "nodeSelector": {
                            "type": "object",
                            "description": "NodeSelector",
                            "default": {},
                            "x-onyxia": {
                                "hidden": false,
                                "overwriteDefaultWith": "region.nodeSelector"
                            }
                        },
                        "serviceAccount": {
                            "type": "object",
                            "abc": false,
                            "properties": {
                                "annotations": {
                                    "type": "object"
                                },
                                "create": {
                                    "type": "boolean",
                                    "default": false
                                },
                                "name": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "loki": {
                    "type": "object",
                    "properties": {
                        "create": {
                            "type": "boolean",
                            "default": true
                        },
                        "service": {
                            "type": "object",
                            "properties": {
                                "port": {
                                    "type": "integer",
                                    "default": 3100
                                },
                                "target_port": {
                                    "type": "integer",
                                    "default": 3100
                                },
                                "type": {
                                    "type": "string",
                                    "default": "ClusterIP"
                                }
                            }
                        },
                        "fullnameOverride": {
                            "type": "string",
                            "x-onyxia": {
                                "hidden": false,
                                "overwriteDefaultWith":"{{project.id}}-{{k8s.randomSubdomain}}-lomas-loki"
                            }
                        },
                        "config": {
                            "type": "object",
                            "properties": {
                                "auth_enabled": {
                                    "type": "boolean",
                                    "default": false
                                },
                                "limits_config": {
                                    "type": "object",
                                    "properties": {
                                        "allow_structured_metadata": {
                                            "type": "boolean",
                                            "default": true
                                        },
                                        "volume_enabled": {
                                            "type": "boolean",
                                            "default": true
                                        }
                                    }
                                },
                                "server": {
                                    "type": "object",
                                    "properties": {
                                        "http_listen_port": {
                                            "type": "integer",
                                            "default": 3100
                                        }
                                    }
                                },
                                "common": {
                                    "type": "object",
                                    "properties": {
                                        "ring": {
                                            "type": "object",
                                            "properties": {
                                                "instance_addr": {
                                                    "type": "string",
                                                    "default": "0.0.0.0"
                                                },
                                                "kvstore": {
                                                    "type": "object",
                                                    "properties": {
                                                        "store": {
                                                            "type": "string",
                                                            "default": "inmemory"
                                                        }
                                                    }
                                                }
                                            }
                                        },
                                        "replication_factor": {
                                            "type": "integer",
                                            "default": 1
                                        },
                                        "path_prefix": {
                                            "type": "string",
                                            "default": "/tmp/loki"
                                        }
                                    }
                                },
                                "schema_config": {
                                    "type": "object",
                                    "properties": {
                                        "configs": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "from": {
                                                        "type": "string",
                                                        "default": "2025-01-10"
                                                    },
                                                    "store": {
                                                        "type": "string",
                                                        "default": "tsdb"
                                                    },
                                                    "object_store": {
                                                        "type": "string",
                                                        "default": "filesystem"
                                                    },
                                                    "schema": {
                                                        "type": "string",
                                                        "default": "v13"
                                                    },
                                                    "index": {
                                                        "type": "object",
                                                        "properties": {
                                                            "prefix": {
                                                                "type": "string",
                                                                "default": "loki_index_"
                                                            },
                                                            "period": {
                                                                "type": "string",
                                                                "default": "24h"
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                },
                                "storage_config": {
                                    "type": "object",
                                    "properties": {
                                        "tsdb_shipper": {
                                            "type": "object",
                                            "properties": {
                                                "active_index_directory": {
                                                    "type": "string",
                                                    "default": "/tmp/loki/index"
                                                },
                                                "cache_location": {
                                                    "type": "string",
                                                    "default": "/tmp/loki/index_cache"
                                                }
                                            }
                                        },
                                        "filesystem": {
                                            "type": "object",
                                            "properties": {
                                                "directory": {
                                                    "type": "string",
                                                    "default": "/tmp/loki/chunks"
                                                }
                                            }
                                        }
                                    }
                                },
                                "pattern_ingester": {
                                    "type": "object",
                                    "properties": {
                                        "enabled": {
                                            "type": "boolean",
                                            "default": true
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "prometheus": {
                    "type": "object",
                    "properties": {
                        "create": {
                            "type": "boolean",
                            "description": "Determines if Prometheus should be created.",
                            "default": true
                        },
                        "service": {
                            "type": "object",
                            "properties": {
                                "port": {
                                    "type": "integer",
                                    "description": "Port on which the Prometheus service is exposed.",
                                    "default": 9091
                                },
                                "target_port": {
                                    "type": "integer",
                                    "description": "Target port for the Prometheus service.",
                                    "default": 9091
                                },
                                "type": {
                                    "type": "string",
                                    "description": "Type of Kubernetes service.",
                                    "default": "ClusterIP"
                                }
                            }
                        },
                        "fullnameOverride": {
                            "type": "string",
                            "description": "Override the full name for Prometheus deployment.",
                            "x-onyxia": {
                                "hidden": false,
                                "overwriteDefaultWith":"{{project.id}}-{{k8s.randomSubdomain}}-lomas-prometheus"
                            }
                        },
                        "config": {
                        "type": "object",
                            "properties": {
                                "scrape_interval": {
                                    "type": "string",
                                    "description": "Global scrape interval for Prometheus.",
                                    "default": "5s"
                                },
                                "evaluation_interval": {
                                    "type": "string",
                                    "description": "Global evaluation interval for Prometheus.",
                                    "default": "5s"
                                }
                            }
                        }
                    }
                },
                "otel": {
                    "type": "object",
                    "properties": {
                        "create": {
                            "type": "boolean",
                            "default": true
                        },
                        "service": {
                            "type": "object",
                            "properties": {
                                "type": {
                                    "type": "string",
                                    "default": "ClusterIP"
                                }
                            }
                        },
                        "fullnameOverride": {
                            "type": "string",
                            "x-onyxia": {
                                "hidden": false,
                                "overwriteDefaultWith":"{{project.id}}-{{k8s.randomSubdomain}}-lomas-otel"
                            }
                        },
                        "config": {
                            "type": "object",
                            "properties": {
                                "receiver": {
                                    "type": "object",
                                    "properties": {
                                        "grpc_port": {
                                            "type": "integer",
                                            "default": 4317
                                        },
                                        "http_port": {
                                            "type": "integer",
                                            "default": 4318
                                        }
                                    }
                                },
                                "processors": {
                                    "type": "object",
                                    "properties": {
                                        "batch": {
                                            "type": "object",
                                            "properties": {
                                                "timeout": {
                                                    "type": "string",
                                                    "default": "5s"
                                                }
                                            }
                                        }
                                    }
                                },
                                "exporters": {
                                    "type": "object",
                                    "properties": {
                                        "prometheus": {
                                            "type": "object",
                                            "properties": {
                                                "port": {
                                                    "type": "integer",
                                                    "default": 8889
                                                }
                                            }
                                        }
                                    }
                                },
                                "extension": {
                                    "type": "object",
                                    "properties": {
                                        "health_check_port": {
                                            "type": "integer",
                                            "default": 13133
                                        },
                                        "pprof_port": {
                                            "type": "integer",
                                            "default": 1777
                                        },
                                        "zpages_port": {
                                            "type": "integer",
                                            "default": 55679
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "tempo": {
                    "type": "object",
                    "properties": {
                        "service": {
                            "type": "object",
                            "properties": {
                                "type": {
                                    "type": "string",
                                    "enum": ["ClusterIP", "NodePort", "LoadBalancer"],
                                    "default": "ClusterIP"
                                }
                            }
                        },
                        "fullnameOverride": {
                            "type": "string",
                            "x-onyxia": {
                                "hidden": false,
                                "overwriteDefaultWith":"{{project.id}}-{{k8s.randomSubdomain}}-lomas-tempo"
                            }
                        },
                        "server": {
                            "type": "object",
                            "properties": {
                                "http_listen_port": {
                                    "type": "integer",
                                    "minimum": 1,
                                    "maximum": 65535,
                                    "default": 3100
                                }
                            }
                        },
                        "ingester": {
                            "type": "object",
                            "properties": {
                                "max_block_duration": {
                                "type": "string",
                                "pattern": "^\\d+m$",
                                "default": "5m"
                                }
                            }
                        },
                        "storage": {
                            "type": "object",
                            "properties": {
                                "trace": {
                                    "type": "object",
                                    "properties": {
                                        "backend": {
                                            "type": "string",
                                            "enum": ["local", "s3", "gcs", "azure"],
                                            "default": "local"
                                        },
                                        "local": {
                                            "type": "object",
                                            "properties": {
                                                "path": {
                                                    "type": "string",
                                                    "default": "/var/tempo/traces"
                                                }
                                            }
                                        }
                                    }
                                },
                                "wal": {
                                    "type": "object",
                                    "properties": {
                                        "path": {
                                            "type": "string",
                                            "default": "/var/tempo/wal"
                                        }
                                    }
                                }
                            }
                        },
                        "receivers": {
                            "type": "object",
                            "properties": {
                                "otlp": {
                                    "type": "object",
                                    "properties": {
                                        "protocols": {
                                            "type": "object",
                                            "properties": {
                                                "grpc": {
                                                    "type": "object",
                                                    "properties": {
                                                        "endpoint": {
                                                            "type": "string",
                                                            "pattern": "^\\d+\\.\\d+\\.\\d+\\.\\d+:\\d+$",
                                                            "default": "0.0.0.0:4317"
                                                        }
                                                    }
                                                },
                                                "http": {
                                                    "type": "object",
                                                    "properties": {
                                                        "endpoint": {
                                                            "type": "string",
                                                            "pattern": "^\\d+\\.\\d+\\.\\d+\\.\\d+:\\d+$",
                                                            "default": "0.0.0.0:4318"
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "overrides": {
                            "type": "object",
                            "properties": {
                                "metrics_generator_processors": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    },
                                    "default": [
                                        "service-graphs",
                                        "span-metrics"
                                    ]
                                }
                            }
                        },
                        "persistence": {
                            "type": "object",
                            "properties": {
                                "enabled": {
                                    "type": "boolean",
                                    "default": false
                                }
                            }
                        }
                    }
                },
                "grafana": {
                    "type": "object",
                    "properties": {
                        "create": {
                            "type": "boolean",
                            "default": true
                        },
                        "service": {
                            "type": "object",
                            "properties": {
                                "type": {
                                    "type": "string",
                                    "default": "ClusterIP"
                                },
                                "port": {
                                    "type": "integer",
                                    "default": 3000
                                }
                            }
                        },
                        "fullnameOverride": {
                            "type": "string",
                            "x-onyxia": {
                                "hidden": false,
                                "overwriteDefaultWith":"{{project.id}}-{{k8s.randomSubdomain}}-lomas-grafana-dashboard"
                            }
                        },
                        "rbac": {
                            "type": "object",
                            "properties": {
                                "create": {
                                    "type": "boolean",
                                    "default": false
                                },
                                "namespaced": {
                                    "type": "boolean",
                                    "default": true
                                }
                            }
                        },
                        "datasources": {
                            "type": "object",
                            "properties": {
                                "datasources.yaml": {
                                    "type": "object",
                                    "properties": {
                                        "apiVersion": {
                                            "type": "integer",
                                            "default": 1
                                        },
                                        "datasources": {
                                            "type": "array",
                                            "items": {
                                                "oneOf": [
                                                {
                                                    "type": "object",
                                                    "properties": {
                                                        "name": { "type": "string", "enum": ["Prometheus"] },
                                                        "type": { "type": "string", "enum": ["prometheus"] },
                                                        "uid": { "type": "string", "enum": ["prometheus"] },
                                                        "access": { "type": "string", "enum": ["proxy"] },
                                                        "orgId": { "type": "integer", "enum": [1] },
                                                        "url": { 
                                                            "type": "string", 
                                                            "default": "http://lomas-prometheus:9091",
                                                            "x-onyxia": {
                                                                "hidden": false,
                                                                "overwriteDefaultWith": "http://{{project.id}}-{{k8s.randomSubdomain}}-lomas-prometheus:9091"
                                                            }
                                                        },
                                                        "basicAuth": { "type": "boolean", "enum": [false] },
                                                        "isDefault": { "type": "boolean", "enum": [false] },
                                                        "version": { "type": "integer", "enum": [1] },
                                                        "editable": { "type": "boolean", "enum": [true] },
                                                        "jsonData": {
                                                            "type": "object",
                                                                "properties": {
                                                                "httpMethod": { "type": "string", "enum": ["GET"] }
                                                            },
                                                            "additionalProperties": false
                                                        }
                                                    }
                                                },
                                                {
                                                    "type": "object",
                                                    "properties": {
                                                        "name": { "type": "string", "enum": ["Tempo"] },
                                                        "type": { "type": "string", "enum": ["tempo"] },
                                                        "uid": { "type": "string", "enum": ["tempo"] },
                                                        "access": { "type": "string", "enum": ["proxy"] },
                                                        "orgId": { "type": "integer", "enum": [1] },
                                                        "url": { 
                                                            "type": "string", 
                                                            "default": "http://lomas-tempo:3100",
                                                            "x-onyxia": {
                                                                "hidden": false,
                                                                "overwriteDefaultWith": "http://{{project.id}}-{{k8s.randomSubdomain}}-lomas-tempo:3100"
                                                            }
                                                        },
                                                        "basicAuth": { "type": "boolean", "enum": [false] },
                                                        "isDefault": { "type": "boolean", "enum": [true] },
                                                        "version": { "type": "integer", "enum": [1] },
                                                        "editable": { "type": "boolean", "enum": [true] },
                                                        "apiVersion": { "type": "integer", "enum": [1] },
                                                        "stream_over_http_enabled": { "type": "boolean", "enum": [false] }
                                                    }
                                                },
                                                {
                                                    "type": "object",
                                                    "properties": {
                                                        "name": { "type": "string", "enum": ["Loki"] },
                                                        "type": { "type": "string", "enum": ["loki"] },
                                                        "uid": { "type": "string", "enum": ["loki"] },
                                                        "access": { "type": "string", "enum": ["proxy"] },
                                                        "orgId": { "type": "integer", "enum": [1] },
                                                        "url": { 
                                                            "type": "string", 
                                                            "default": "http://lomas-loki:3100",
                                                            "x-onyxia": {
                                                                "hidden": false,
                                                                "overwriteDefaultWith": "http://{{project.id}}-{{k8s.randomSubdomain}}-lomas-loki:3100"
                                                            }
                                                        },
                                                        "basicAuth": { "type": "boolean", "enum": [false] },
                                                        "isDefault": { "type": "boolean", "enum": [false] },
                                                        "version": { "type": "integer", "enum": [1] },
                                                        "editable": { "type": "boolean", "enum": [true] },
                                                        "jsonData": {
                                                            "type": "object",
                                                            "properties": {
                                                            "httpHeaderName1": { "type": "string", "enum": ["X-Scope-OrgID"] }
                                                            },
                                                            "additionalProperties": false
                                                        },
                                                        "secureJsonData": {
                                                            "type": "object",
                                                            "properties": {
                                                            "httpHeaderValue1": { "type": "string", "enum": ["tenant1"] }
                                                            },
                                                            "additionalProperties": false
                                                        }
                                                    }
                                                }
                                                ]
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "env": {
                            "type": "object",
                            "properties": {
                                "GF_SECURITY_ADMIN_USER": {
                                    "type": "string",
                                    "default": "admin"
                                },
                                "GF_SECURITY_ADMIN_PASSWORD": {
                                    "type": "string",
                                    "default": "admin"
                                }
                            }
                        },
                        "ingress": {
                            "type": "object",
                            "properties": {
                                "enabled": {
                                    "type": "boolean",
                                    "default": true
                                },
                                "hosts": {
                                    "type": "array",
                                    "items": {
                                        "oneOf": [
                                            {
                                                "type": "string",
                                                "x-onyxia": {
                                                    "hidden": false,
                                                    "overwriteDefaultWith": "{{project.id}}-{{k8s.randomSubdomain}}-lomas-monitoring-dashboard-{{k8s.domain}}"
                                                }
                                            }
                                        ]
                                    }
                                }
                            }
                        },
                        "persistence": {
                            "type": "object",
                            "properties": {
                                "enabled": {
                                    "type": "boolean",
                                    "default": false
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
